<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Mini Phaser Platformer ‚Äî Playable</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { margin:0; background:#1e1f26; color:#fff; font-family:Arial,Helvetica,sans-serif; }
    #game-container { width:100%; height:90vh; display:flex; align-items:center; justify-content:center; }
    .instructions {
      background:#2e2f38; padding:10px 15px; text-align:center;
      font-size:16px; color:#f5f5f5; border-bottom:2px solid #444;
    }
    .credits { position:fixed; left:8px; bottom:8px; font-size:12px; opacity:0.8; }
  </style>
</head>
<body>
  <div class="instructions">
    üéÆ <strong>How to Play:</strong>  
    Use <b>‚Üê</b> and <b>‚Üí</b> to move, <b>‚Üë</b> or <b>Space</b> to jump.  
    Collect ‚≠ê stars for points. Avoid the red enemy ‚Äî stomping from above defeats it.  
    If you fall or touch the enemy, you lose. Collect all stars to win!  
  </div>
  <div id="game-container"></div>
  <div class="credits">Mini Game Example ‚Äî Powered by Phaser 3</div>

  <!-- Phaser 3 from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>

  <script>
  const WIDTH = 800;
  const HEIGHT = 600;

  class MainScene extends Phaser.Scene {
    constructor() { super('MainScene'); }

    create() {
      this.cameras.main.setBackgroundColor('#2b2f39');
      this.physics.world.setBounds(0, 0, WIDTH, HEIGHT);
      this.createTextures();

      // Platforms
      this.platforms = this.physics.add.staticGroup();
      this.platforms.create(WIDTH/2, HEIGHT-24, 'tile').setScale(16,1).refreshBody();
      this.platforms.create(150, 440, 'tile');
      this.platforms.create(400, 360, 'tile');
      this.platforms.create(650, 280, 'tile');
      this.platforms.create(300, 220, 'tile');

      // Player
      this.player = this.physics.add.sprite(100, HEIGHT-120, 'player');
      this.player.setCollideWorldBounds(true).setBounce(0.05);
      this.player.body.setSize(26,38);
      this.player.speed = 220;
      this.player.jumpForce = -420;

      // Enemy
      this.enemy = this.physics.add.sprite(520, HEIGHT-120, 'enemy');
      this.enemy.setCollideWorldBounds(true).setBounce(0.2);
      this.enemy.patrolLeft = 480;
      this.enemy.patrolRight = 720;
      this.enemy.setVelocityX(-80);

      // Stars
      this.stars = this.physics.add.group({
        key: 'star', repeat: 7, setXY: { x: 80, y: 0, stepX: 90 }
      });
      this.stars.children.iterate(c => c.setBounceY(Phaser.Math.FloatBetween(0.2, 0.6)));

      // UI
      this.score = 0;
      this.scoreText = this.add.text(16, 16, 'Score: 0', { font: '20px Arial', fill: '#ffffff' }).setScrollFactor(0);
      this.message = this.add.text(WIDTH/2, 120, '', { font: '28px Arial', fill: '#ffffff' }).setOrigin(0.5);
      this.restartBtn = this.add.text(WIDTH/2, HEIGHT/2 + 40, 'Restart', { font: '26px Arial', fill: '#000' })
        .setOrigin(0.5).setPadding(10).setInteractive().setVisible(false)
        .setStyle({ backgroundColor: '#fff' })
        .on('pointerdown', () => this.scene.restart());

      // Physics
      this.physics.add.collider(this.player, this.platforms);
      this.physics.add.collider(this.stars, this.platforms);
      this.physics.add.collider(this.enemy, this.platforms);
      this.physics.add.overlap(this.player, this.stars, this.collectStar, null, this);
      this.physics.add.collider(this.player, this.enemy, this.handlePlayerEnemy, null, this);

      // Controls
      this.cursors = this.input.keyboard.createCursorKeys();
      this.totalStars = this.stars.getChildren().length;
      this.gameOver = false; this.won = false;
    }

    createTextures() {
      const g = this.add.graphics();
      g.fillStyle(0x4fc3f7, 1).fillRoundedRect(0,0,32,48,6).generateTexture('player',32,48).clear();
      g.fillStyle(0x6d6e76,1).fillRect(0,0,64,24).lineStyle(2,0x55565b,1);
      for(let i=0;i<4;i++) g.strokeRect(i*16,0,16,24);
      g.generateTexture('tile',64,24).clear();
      g.fillStyle(0xffd54f,1).beginPath(); const cx=12,cy=12,r=10;
      for(let i=0;i<5;i++){const a=(i*2*Math.PI)/5-Math.PI/2;const ax=cx+Math.cos(a)*r;const ay=cy+Math.sin(a)*r;i?g.lineTo(ax,ay):g.moveTo(ax,ay);}
      g.closePath().fillPath().generateTexture('star',24,24).clear();
      g.fillStyle(0xef5350,1).fillEllipse(22,17,44,34).generateTexture('enemy',44,34).clear().destroy();
    }

    collectStar(player, star) {
      star.disableBody(true, true);
      this.score += 10; this.scoreText.setText('Score: ' + this.score);
      const p = this.add.circle(star.x, star.y, 6, 0xffd54f).setAlpha(0.9);
      this.tweens.add({ targets: p, y: star.y-40, alpha:0, scale:0.3, duration:500, onComplete:()=>p.destroy() });
      if (this.stars.countActive(true) === 0) this.winGame();
    }

    handlePlayerEnemy(player, enemy) {
      if (this.gameOver || this.won) return;
      if (player.body.velocity.y > 0 && (player.y+10) < enemy.y) {
        enemy.disableBody(true, true);
        this.score += 25; this.scoreText.setText('Score: ' + this.score);
        player.setVelocityY(this.player.jumpForce*0.5);
      } else { this.playerDie(); }
    }

    playerDie() {
      if (this.gameOver) return;
      this.gameOver = true;
      this.player.setTint(0x666666).setVelocity(0,-150);
      this.message.setText('You Died'); this.restartBtn.setVisible(true);
    }

    winGame() {
      if (this.won) return;
      this.won = true;
      this.message.setText('You Collected All Stars! You Win üéâ');
      this.time.delayedCall(300, ()=> this.restartBtn.setVisible(true));
    }

    update() {
      if (this.gameOver || this.won) return;
      if (this.enemy.active) {
        if (this.enemy.x <= this.enemy.patrolLeft) this.enemy.setVelocityX(80);
        else if (this.enemy.x >= this.enemy.patrolRight) this.enemy.setVelocityX(-80);
      }
      const left = this.cursors.left.isDown;
      const right = this.cursors.right.isDown;
      const jump = Phaser.Input.Keyboard.JustDown(this.cursors.up) || Phaser.Input.Keyboard.JustDown(this.cursors.space);
      if (left) this.player.setVelocityX(-this.player.speed);
      else if (right) this.player.setVelocityX(this.player.speed);
      else this.player.setVelocityX(0);
      if (jump && (this.player.body.blocked.down || this.player.body.touching.down)) {
        this.player.setVelocityY(this.player.jumpForce);
      }
      if (this.player.y > HEIGHT+200) this.playerDie();
    }
  }

  const config = { type: Phaser.AUTO, width: WIDTH, height: HEIGHT, parent: 'game-container',
    physics: { default: 'arcade', arcade: { gravity: { y: 900 }, debug: false } },
    scene: [ MainScene ], backgroundColor: '#222' };
  const game = new Phaser.Game(config);
  </script>
</body>
</html>
